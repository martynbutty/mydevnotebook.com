"use strict";(self.webpackChunkmydevnotebook_com=self.webpackChunkmydevnotebook_com||[]).push([[234],{3905:function(e,t,n){n.d(t,{Zo:function(){return l},kt:function(){return m}});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var i=r.createContext({}),u=function(e){var t=r.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},l=function(e){var t=u(e.components);return r.createElement(i.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},f=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,i=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),p=u(n),f=o,m=p["".concat(i,".").concat(f)]||p[f]||d[f]||a;return n?r.createElement(m,s(s({ref:t},l),{},{components:n})):r.createElement(m,s({ref:t},l))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,s=new Array(a);s[0]=f;var c={};for(var i in t)hasOwnProperty.call(t,i)&&(c[i]=t[i]);c.originalType=e,c[p]="string"==typeof e?e:o,s[1]=c;for(var u=2;u<a;u++)s[u]=n[u];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}f.displayName="MDXCreateElement"},5319:function(e,t,n){n.r(t),n.d(t,{assets:function(){return i},contentTitle:function(){return s},default:function(){return d},frontMatter:function(){return a},metadata:function(){return c},toc:function(){return u}});var r=n(3117),o=(n(7294),n(3905));const a={title:"AWS CDK dependent stacks",description:"How to decouple dependent AWS stacks",authors:["martyn"],hide_table_of_contents:!1},s="AWS CDK export cannot be deleted as it is in use",c={permalink:"/blog/2023/07/11/CDK-dependent-stacks",source:"@site/blog/2023-07-11-CDK-dependent-stacks/index.md",title:"AWS CDK dependent stacks",description:"How to decouple dependent AWS stacks",date:"2023-07-11T00:00:00.000Z",formattedDate:"July 11, 2023",tags:[],readingTime:5.965,hasTruncateMarker:!0,authors:[{name:"Martyn Butterworth",title:"Technical Architect",url:"https://github.com/MartynButty",imageURL:"https://github.com/MartynButty.png",key:"martyn"}],frontMatter:{title:"AWS CDK dependent stacks",description:"How to decouple dependent AWS stacks",authors:["martyn"],hide_table_of_contents:!1},prevItem:{title:"Aurora Serverless Database Selection",permalink:"/blog/2023/08/01/Aurora-Serverless-database-selection"},nextItem:{title:"Performance Testing Basics",permalink:"/blog/2022/09/06/Performance-Testing-Basics"}},i={authorsImageUrls:[void 0]},u=[{value:"AWS CDK dependent stacks",id:"aws-cdk-dependent-stacks",level:2}],l={toc:u},p="wrapper";function d(e){let{components:t,...a}=e;return(0,o.kt)(p,(0,r.Z)({},l,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,'Sometimes you try deploying a change to an existing multi-stack CDK project, only to get an error message similar to "',(0,o.kt)("strong",{parentName:"p"},"Export cannot be deleted as it is in use"),"\". Read on if you've encountered this error and are struggling to fix it, or you're just interested in finding out about dependent stacks in AWS."),(0,o.kt)("h2",{id:"aws-cdk-dependent-stacks"},"AWS CDK dependent stacks"),(0,o.kt)("p",null,"AWS CDK makes it easy to share resources in different stacks. For example, allowing an SQS queue from one stack to be used by a lambda in a different stack. In this case, CDK automatically takes care of cross stack references, and also ensures deployments happen in the correct order."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"CDK dependent stacks architecture",src:n(5884).Z,width:"623",height:"301"})),(0,o.kt)("p",null,"The problem you've probably encountered seeing as you're here, is that you're trying to remove  that cross stack reference, but you see  something like:\n",(0,o.kt)("inlineCode",{parentName:"p"},"Export <<some AWS ref>> cannot be deleted as it is in use by <<some stack>>")))}d.isMDXComponent=!0},5884:function(e,t,n){t.Z=n.p+"assets/images/DependentStacks-299bd51aa765cfff1a7e67cd60fde1f9.png"}}]);